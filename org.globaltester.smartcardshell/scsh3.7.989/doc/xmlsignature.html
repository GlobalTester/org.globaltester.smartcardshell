<!-- #BeginTemplate "template.dwt" -->
        <!doctype html public "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<!-- #BeginEditable "TITLE" -->
                <title>XMLSignature - Reference Documentation</title>
                    <!-- #EndEditable -->
<link rel=stylesheet type="text/css" href="style.css">
<meta name="author" content="Andreas Schwier">
</head>
<body>
<div align="left"><a href="http://www.cardcontact.de"><img src="banner.jpg" width="750" height="80" border="0"></a></div>
<div id="navigator">
    <p><b>Smart Card<br>Shell 3</b></p>
    <a href="index.html">Home</a><br><br>
    <a href="gperror.html">GPError</a><br>
    <a href="gpsystem.html">GPSystem</a><br>
    <a href="bytestring.html">ByteString</a><br>
    <a href="bytebuffer.html">ByteBuffer</a><br>
    <a href="tlv.html">TLV</a><br>
    <a href="tlvlist.html">TLVList</a><br>
    <a href="card.html">Card</a><br>
    <a href="atr.html">Atr</a><br>
    <a href="key.html">Key</a><br>
    <a href="crypto.html">Crypto</a><br>
    <a href="application.html">Application</a><br>
    <a href="gpapplication.html">GPApplication</a><br>
    <a href="gpsecuritydomain.html">GPSecDomain</a><br>
    <br>
    <a href="asn1.html">ASN1</a><br>
    <a href="cardfile.html">CardFile</a><br>
    <a href="isosecurechannel.html">IsoSecureChannel</a><br>
    <a href="applicationfactory.html">ApplFactory</a><br>
    <a href="gpxml.html">GPXML</a><br>
    <a href="jsscript.html">JsScript</a><br>
    <a href="cardsimulationadapter.html">CardSim</a><br>
    <br>
    <a href="x509.html">X509</a><br>
    <a href="crl.html">CRL</a><br>
    <a href="keystore.html">KeyStore</a><br>
    <a href="cmssigneddata.html">CMSSignedData</a><br>
    <a href="cmsgenerator.html">CMSGenerator</a><br>
    <a href="xmlsignature.html">XMLSignature</a><br>
    <a href="ocspquery.html">OCSPQuery</a><br>
    <a href="ldap.html">LDAP</a><br>
    <a href="soapconnection.html">SOAP</a><br>
    <a href="urlconnection.html">URLConnection</a><br>
    <br>
    <a href="pkcs11provider.html">PKCS11Provider</a><br>
    <a href="pkcs11session.html">PKCS11Session</a><br>
    <a href="pkcs11object.html">PKCS11Object</a><br>
    <br>
    <a href="outlinenode.html">OutlineNode</a><br>
    <a href="dialog.html">Dialog</a><br>
    <br>
    <a href="jsdoc/index.html">Tools</a><br>
    <br>
    <a href="http://www.openscdp.org">OpenSCDP</a><br>
</div>

<div id="main">
<!-- #BeginEditable "BODY" -->
                <h1>XMLSignature - Reference Documentation</h1>
<p>
<p>Class implementing support for XML Digital Signatures</p>
                 
<p>This class provides for the ability to create and verify XML Digital Signatures.</p>
</p>
<h2>Index of Methods</h2>
<ul>
<li>
<a href="#Constructor">XMLSignature() constructor</a>
</li>
<li>
<a href="#addReference">addReference()</a>
</li>
<li>
<a href="#sign">sign()</a>
</li>
<li>
<a href="#verify">verify()</a>
</li>
<li>
<a href="#saveAs">saveAs()</a>
</li>
</ul>
<h2>Constants</h2>
<table class="content">
<colgroup>
<col width="100">
<col width="200">
<col>
</colgroup>
<tr>
<th>Type</th><th>Name</th><th>Description</th>
</tr>
<tr>
<td>String</td><td>INCLUSIVE</td><td>The Canonical XML (without comments) canonicalization method algorithm URI</td>
</tr>
<tr>
<td>String</td><td>INCLUSIVE_WITH_COMMENTS</td><td>The Canonical XML with comments canonicalization method algorithm URI</td>
</tr>
<tr>
<td>String</td><td>EXCLUSIVE</td><td>The Exclusive Canonical XML (without comments) canonicalization method algorithm URI</td>
</tr>
<tr>
<td>String</td><td>EXCLUSIVE_WITH_COMMENTS</td><td>The Exclusive Canonical XML with comments canonicalization method algorithm URI</td>
</tr>
<tr>
<td>String</td><td>BASE64</td><td>The Base64 transform algorithm URI</td>
</tr>
<tr>
<td>String</td><td>ENVELOPED</td><td>The Enveloped Signature transform algorithm URI</td>
</tr>
<tr>
<td>String</td><td>XPATH</td><td>The XPath transform algorithm URI</td>
</tr>
<tr>
<td>String</td><td>XPATH2</td><td>The XPath Filter 2 transform algorithm URI</td>
</tr>
<tr>
<td>String</td><td>XSLT</td><td>The XSLT transform algorithm URI</td>
</tr>
</table>
<h2 id="Constructor">Constructor</h2>
<h3>Prototype</h3>
<p class="signature">XMLSignature(String filename)</p>
<h3>Description</h3>Create object and initialize from document in referenced file.<h3>Arguments</h3>
<table class="content">
<colgroup>
<col width="100">
<col width="100">
<col>
</colgroup>
<tr>
<th>Type</th><th>Name</th><th>Description</th>
</tr>
<tr>
<td><code>String</code></td><td>filename</td><td>Name of file containing XML document, signed or unsigned.</td>
</tr>
</table>
<h3>Exceptions</h3>
<table class="content">
<colgroup>
<col width="100">
<col width="200">
<col>
</colgroup>
<tr>
<th>Name</th><th>Value</th><th>Description</th>
</tr>
<tr>
<td>GPError</td><td>GPError.ARGUMENTS_MISSING</td><td>Too few arguments in call</td>
</tr>
<tr>
<td>GPError</td><td>GPError.INVALID_ARGUMENTS</td><td>Too many arguments in call</td>
</tr>
<tr>
<td>GPError</td><td>GPError.INVALID_TYPE</td><td>Type of argument is invalid for call</td>
</tr>
</table>
<h3>Example</h3>
<pre>

var ds = new XMLSignature("xmlsig1.xml");

</pre>
<h2 id="addReference">addReference()</h2>
<h3>Prototype</h3>
<p class="signature">void addReference(String uri, Number digestMech)</p>
<p class="signature">void addReference(String uri, Number digestMech, String[] transformations)</p>
<h3>Description</h3>
<p>Add a reference to the SignedInfo</p>
<h3>Arguments</h3>
<table class="content">
<colgroup>
<col width="100">
<col width="100">
<col>
</colgroup>
<tr>
<th>Type</th><th>Name</th><th>Description</th>
</tr>
<tr>
<td><code>String</code></td><td>uri</td><td>The URI pointing to the signed data</td>
</tr>
<tr>
<td><code>Number</code></td><td>digestMech</td><td>One of Crypto.SHA_1, Crypto.SHA_256, Crypto.SHA_512 or Crypto.MD5</td>
</tr>
<tr>
<td><code>String[]</code></td><td>transformations</td><td>List of transformations to apply for reference</td>
</tr>
</table>
<h3>Return</h3>
<table>
<colgroup>
<col width="100">
<col>
</colgroup>
<tr>
<td><code></code></td><td></td>
</tr>
</table>
<h3>Exceptions</h3>
<table class="content">
<colgroup>
<col width="100">
<col width="200">
<col>
</colgroup>
<tr>
<th>Name</th><th>Value</th><th>Description</th>
</tr>
<tr>
<td>GPError</td><td>GPError.ARGUMENTS_MISSING</td><td>Too few arguments in call</td>
</tr>
<tr>
<td>GPError</td><td>GPError.INVALID_ARGUMENTS</td><td>Too many arguments in call</td>
</tr>
<tr>
<td>GPError</td><td>GPError.INVALID_TYPE</td><td>Type of argument is invalid for call</td>
</tr>
</table>
<h3>Example</h3>
<pre>

ds.addReference("", Crypto.SHA_256, [XMLSignature.ENVELOPED]);
ds.addReference("./xmlsig1.xml", Crypto.SHA_256);

</pre>
<h2 id="sign">sign()</h2>
<h3>Prototype</h3>
<p class="signature">void sign(Crypto crypto, String c14n, Number mech, Key privateKey, Key publicKey)</p>
<h3>Description</h3>
            
<p>Create signature using the private key and signature mechanism.</p>
            
<p>The data to be signed is canonicalized using the selected method.</p>
            
<p>The public key is stored in the KeyInfo section.</p>
        
<h3>Arguments</h3>
<table class="content">
<colgroup>
<col width="100">
<col width="100">
<col>
</colgroup>
<tr>
<th>Type</th><th>Name</th><th>Description</th>
</tr>
<tr>
<td><code>Crypto</code></td><td>crypto</td><td>The crypto service to use</td>
</tr>
<tr>
<td><code>String</code></td><td>c14n</td><td>The canonicalization method to apply</td>
</tr>
<tr>
<td><code>Key</code></td><td>mech</td><td>The signature mechanism to use</td>
</tr>
<tr>
<td><code>Key</code></td><td>privateKey</td><td>The private key used for signing</td>
</tr>
<tr>
<td><code>Key</code></td><td>publicKey</td><td>The public key to be included in KeyInfo</td>
</tr>
</table>
<h3>Return</h3>
<table>
<colgroup>
<col width="100">
<col>
</colgroup>
<tr>
<td><code></code></td><td></td>
</tr>
</table>
<h3>Exceptions</h3>
<table class="content">
<colgroup>
<col width="100">
<col width="200">
<col>
</colgroup>
<tr>
<th>Name</th><th>Value</th><th>Description</th>
</tr>
<tr>
<td>GPError</td><td>GPError.ARGUMENTS_MISSING</td><td>Too few arguments in call</td>
</tr>
<tr>
<td>GPError</td><td>GPError.INVALID_ARGUMENTS</td><td>Too many arguments in call</td>
</tr>
<tr>
<td>GPError</td><td>GPError.INVALID_TYPE</td><td>Type of argument is invalid for call</td>
</tr>
<tr>
<td>GPError</td><td>GPError.CRYPTO_FAILED</td><td>The cryptographic signing operation failed</td>
</tr>
</table>
<h3>Example</h3>
<pre>

// Create empty public key object and set size
var pubKey = new Key();
pubKey.setType(Key.PUBLIC);
pubKey.setSize(1024);

// Create empty private key object and set size
var priKey = new Key();
priKey.setType(Key.PRIVATE);

var crypto = new Crypto();

// Generate key pair
crypto.generateKeyPair(Crypto.RSA, pubKey, priKey);

ds.sign(crypto, XMLSignature.EXCLUSIVE, Crypto.RSA_SHA256, priKey, pubKey);

</pre>
<h2 id="verify">verify()</h2>
<h3>Prototype</h3>
<p class="signature">boolean verify(Crypto crypto, Key publicKey)</p>
<h3>Description</h3>
            
<p>Verify XML signature using the public key provided.</p>
        
<h3>Arguments</h3>
<table class="content">
<colgroup>
<col width="100">
<col width="100">
<col>
</colgroup>
<tr>
<th>Type</th><th>Name</th><th>Description</th>
</tr>
<tr>
<td><code>Crypto</code></td><td>crypto</td><td>The crypto service to use</td>
</tr>
<tr>
<td><code>Key</code></td><td>publicKey</td><td>The public key to be used for verification</td>
</tr>
</table>
<h3>Return</h3>
<table>
<colgroup>
<col width="100">
<col>
</colgroup>
<tr>
<td><code></code></td><td></td>
</tr>
</table>
<h3>Exceptions</h3>
<table class="content">
<colgroup>
<col width="100">
<col width="200">
<col>
</colgroup>
<tr>
<th>Name</th><th>Value</th><th>Description</th>
</tr>
<tr>
<td>GPError</td><td>GPError.ARGUMENTS_MISSING</td><td>Too few arguments in call</td>
</tr>
<tr>
<td>GPError</td><td>GPError.INVALID_ARGUMENTS</td><td>Too many arguments in call</td>
</tr>
<tr>
<td>GPError</td><td>GPError.INVALID_TYPE</td><td>Type of argument is invalid for call</td>
</tr>
<tr>
<td>GPError</td><td>GPError.CRYPTO_FAILED</td><td>The cryptographic verifying operation failed</td>
</tr>
</table>
<h3>Example</h3>
<pre>

assert(ds.verify(crypto, pubKey));

</pre>
<h2 id="saveAs">saveAs()</h2>
<h3>Prototype</h3>
<p class="signature">void saveAs(String filename)</p>
<h3>Description</h3>
<p>Save XML Digital Signature to file.</p>
<h3>Return</h3>
<table>
<colgroup>
<col width="100">
<col>
</colgroup>
<tr>
<td><code></code></td><td></td>
</tr>
</table>
<h3>Exceptions</h3>
<table class="content">
<colgroup>
<col width="100">
<col width="200">
<col>
</colgroup>
<tr>
<th>Name</th><th>Value</th><th>Description</th>
</tr>
<tr>
<td>GPError</td><td>GPError.ARGUMENTS_MISSING</td><td>Too few arguments in call</td>
</tr>
<tr>
<td>GPError</td><td>GPError.INVALID_ARGUMENTS</td><td>Too many arguments in call</td>
</tr>
<tr>
<td>GPError</td><td>GPError.INVALID_TYPE</td><td>Type of argument is invalid for call</td>
</tr>
</table>
<h3>Example</h3>
<pre>

var fn = GPSystem.mapFilename("xmlsig2.xml", GPSystem.CWD);

ds.saveAs(fn);

</pre>
                    <!-- #EndEditable -->
<br>
<p class="copyright">&copy; Copyright 2003 - 2010 <a href="http://www.cardcontact.de">CardContact</a>
Software & System Consulting, Minden, Germany</p>
</div>

</body>
</html><!-- #EndTemplate -->
        
